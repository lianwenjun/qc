<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="http://localhost/css/admin/main.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript"  src="http://localhost/js/jquery.min.js"></script>
    <!-- 弹窗 -->
    <link href="http://localhost/css/admin/jBox/Skins/Default/jbox.css" rel="stylesheet" type="text/css" />
    <script src="http://localhost/js/admin/jBox/jquery.jBox-2.3.min.js" type="text/javascript"></script>
    <script src="http://localhost/js/admin/jBox/i18n/jquery.jBox-zh-CN.js" type="text/javascript"></script>
    <!--/ 弹窗 -->
</head>
<body>
     
        
<div class="Content_right_top Content_height">
    <div class="Theme_title"><h1>系统管理 <span> 关键字管理</span></h1></div>

    <div class="Theme_Search">
        <ul>
            <li>
               <span><b>关键词添加：</b>
               <input id="addWord" name="word" type="text" class="Search_wenben" size="30" value="添加关键词" />
               </span>
               <input id="submitWord" name="" type="submit" value="添加" class="Search_en" />
            </li>
            <li>
               <span><b>查询：</b>
               <input id="searchWord" name="word" type="text" class="Search_wenben" size="30" value="输入关键字" />
               </span>
               <input id="submitSearch" name="" type="submit" value="搜索" class="Search_en" />
            </li>
        </ul>
    </div>
                    
    <div class="Search_cunt">共 <strong>0</strong> 条记录 </div>

    <div class="Search_biao">
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
            <tr class="Search_biao_title">
                <td width="4%">ID</td>
                <td width="20%">关键字</td>
                <td width="9%">自然搜索量</td>
                <td width="8%">添加人</td>
                <td width="12%">添加时间</td>
                <td width="9%">最后编辑人</td>
                <td width="12%">最后更新时间</td>
                <td width="8%">是否轮播</td>
                <td width="12%">操作</td>
            </tr>
                   </table>
       <div id="pager"></div>
      </div>                   
</div>
<script>
$(function(){
    CREATEURL = "http://localhost/admin/keyword/create";
    
    $("#addWord").focus(function() {
        $(this).val("");
    });
    $("#searchWord").focus(function() {
        $(this).val("");
    });
    //提交添加
    $("#submitWord").click(function() {
        var word = $("#addWord").val();
        if (word === "添加关键词" || word == "") {
            $("#addWord").val("添加关键词");
            return;
        }
        // 添加关键词
        var url = CREATEURL;
        var data = {word:word};
        // 发送数据
        $.post(url, data, function(res) {
            //错误判断
            if (res.status != 'ok') {
                alert('添加' + word + '失败');
                return;
            }
            //成功返回刷新页面
            window.location.href = window.location.pathname;
        }).fail(function() {
            alert('亲，服务器出错啦');
        });
    });
    //提交查询
    $("#submitSearch").click(function() {
        var word = $("#searchWord").val();
        if (word === "输入关键字" || word == "") {
            $("#searchWord").val("输入关键字");
            return;
        }
        // 查询
        var url = window.location.pathname + '?word=' + word;
        window.location.href = url;
    });
    //删除
    $('.delWord').live('click', function() {
        var td = $(this).parents('tr').children('td');
        var delUrl = td.eq(9).find('#del-url').val();
        window.location.href = delUrl;
    });
    //修改
    $(".editWord").live('click', function() {
        var td = $(this).parents('tr').children('td');
        var text1 = td.eq(1).html();
        var text7 = td.eq(7).html();
        var text8 = $(this).parent().html();
        var to_text1 = '<input name="textfield2" type="text" id="textfield2" value="" size="8" class="Classification_text" />';
        var to_text7 = '';
        var to_text8 = '<a href="javacript:;" class="Search_show saveWord">确定</a> <a href="javacript:;" class="Search_show chanceWord">取消</a>';
        td.eq(1).html(to_text1);
        td.eq(1).find('#textfield2').val(text1);
        $(this).parent().html(to_text8);
    });
    //提交
    $(".saveWord").live('click', function() {
        //alert('点击保存');
        var td = $(this).parents('tr').children('td');
        var text1 = td.eq(1).find('input').val();
        var editUrl = td.eq(9).find('#edit-url').val();
        //var is_slide = td.eq().
        var data = {word:text1, is_slide:'yes'};
        $.post(editUrl, data, function(res) {
            //错误判断
            if (res.status == 'ok') {
                var text8 = '<a href="javacript:;" class="Search_show editWord">修改</a> <a href="javascript:;" class="Search_del delWord">删除</a>';
                td.eq(8).html(text8);
                td.eq(1).html(text1);
                return;
            }
            return;
        }).fail(function() {
            alert('亲，服务器出错啦');
        });
    });
    //取消
    $(".chanceWord").live('click', function() {
        var td = $(this).parents('tr').children('td');
        var text1 = td.eq(9).find('#preWord').val();
        var text8 = '<a href="javacript:;" class="Search_show editWord">修改</a> <a href="javascript:;" class="Search_del delWord">删除</a>';
        $(this).parent().html(text8);
        td.eq(1).html(text1);
        //td.eq(9).find('input').val(text1);
    });
});
</script>
    <div class="Content_foot">
        <div class="Content_bottom"><a href="javascript:alert('还没有东西哦!');">使用前必读</a> 粤ICP证030173号</div>
    </div>
</body>
</html>